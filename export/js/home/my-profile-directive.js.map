{"version":3,"names":[],"mappings":"","sources":["home/my-profile-directive.js"],"sourcesContent":["/* global Firebase */\n(function () {\n  'use strict';\n\n  /**\n   * @ngdoc directive\n   * @name home.directive:myProfile\n   * @restrict EA\n   * @element\n   *\n   * @description\n   *\n   * @example\n     <example module=\"home\">\n       <file name=\"index.html\">\n        <my-profile></my-profile>\n       </file>\n     </example>\n   *\n   */\n  angular\n    .module('home')\n    .directive('myProfile', myProfile);\n\n  function myProfile() {\n    return {\n      restrict: 'EA',\n      scope: {\n        name: '=',\n        loggedIn: '='\n      },\n      bindToController: true,\n      templateUrl: 'home/my-profile-directive.tpl.html',\n      controllerAs: 'myProfile',\n      controller: function ($scope) {\n        var vm = this,\n            ref = new Firebase('https://amigo-secreto.firebaseio.com');\n        vm.save = save;\n        vm.cancel = cancel;\n        vm.edit = edit;\n        vm.onChange = onChange;\n        vm.changed = false;\n        $scope.$watch('myProfile.loggedIn', function () {\n          if (angular.isString(vm.name)) {\n            if (vm.name.length > 5) {\n              $getWishes(vm.name, function (wishes) {\n                vm.savedWishes = wishes;\n                vm.wishes = wishes;\n              });\n            }\n          } else {\n            vm.savedWishes = '';\n            vm.wishes = '';\n          }\n        });\n\n        function save() {\n          $save(vm.name, vm.wishes, function () {\n            vm.savedWishes = vm.wishes;\n            vm.changed = false;\n          });\n        }\n\n        function cancel() {\n          vm.wishes = vm.savedWishes;\n          vm.changed = false;\n        }\n\n        function edit() {\n          vm.wishes = vm.savedWishes;\n          vm.changed = true;\n        }\n\n        function $save(name, wishes, callback) {\n          ref.child(name).child('wishes').set(wishes, callback);\n        }\n\n        function $getWishes(name, callback) {\n          ref.child(name).child('wishes').on('value', function (snapshot) {\n            callback(snapshot.val());\n          });\n        }\n\n        function onChange() {\n          vm.changed = true;\n        }\n      },\n      link: function (scope, element, attrs) {\n        /* jshint unused:false */\n        /* eslint \"no-unused-vars\": [2, {\"args\": \"none\"}] */\n      }\n    };\n  }\n}());\n"],"file":"home/my-profile-directive.js","sourceRoot":"/source/"}